$START\ TABLE\ ***********************************.'Moveflag=&7B.'Renum=&80.'Temp=&81\ **** TABLE LINE REFERENCES ****.'TABLE\CHECK LINE NUMBERS AND TABLE REFERENCESJSR StartB \Set (B) to PAGEINY \=1LDA(&B),YBMI Finished \TOP if bit7 set.R1 LDY#4 \Text starts 4 bytes in.R2 LDA(&B),YCMP#&8D \Line# marker?BEQ GotoneINYCMP#&D \CR?BNE R2 \Wait for end of lineLDA(&B),Y \Pick up first byte of next lineORA &FF \Test EscapeBMI Sort \Escaped or TOPJSR UpB \Update (B) pointerBCC R1\\.Gotone \Line reference found, check if it existsJSR LINBINY \ConJert no. to binary in IAC, save Y in &AJSR FindlineBNE Failed \Line not found\Match found, reference OKLDY&ABNE R2 \Continue looking for 8D's.Failed JSR LINIAC \Print line# not foundJSR LineB_iac \Put calling line# in IACJSR NonexistentLDY &A \Pickup original offsetBNE R2 \Continue looking for &8D's\\\ **********************************.done JSR OSNEWL \CR.Finished JMP Choice\.Sort\Print reference table in line# orderJSR Start \Set (71) to PAGE.S0 JSR LineiachiBMI doneBIT&FFBMI Finished \EscapedJSR Findcall \Search prgm for any reference to line# in 2C/2D.S6 BNE S5 \No call foundJSR Iachi_lo \Copy # into 2A/2BJSR OSNEWL \CRJSR LINIAC \Print # in 5 field of referenced lineJSR Printmsg$EQUS "   "$EQUB 0.S7 JSR Printmsg \Call of line# in 2C/2D found$EQUS " ("$EQUB 0LDY&A \Offset Y in line (B),YJSR LineB_iac \Put line# in 2A/BJSR LINIAC \Print # in 5 fieldLDA#")"JSR OSWRCHLDY&A \Offset Y in line (B),YJSR Findcall2 \Continue search for any further calls of same lineBEQ S7 \Another call found.S5 JSR Nextline \Update (71) ptrBNE S0 \Check next line#$END